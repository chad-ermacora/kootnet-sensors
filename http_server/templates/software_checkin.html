{% extends "base.html" %}

{% block content %}
    <meta http-equiv="refresh" content="300; url = {{ PageURL }}"/>

    <script>
        function DeleteSensorID() {
            let r = confirm("Sensor deletions cannot be undone, are you sure?");
            if (r === true) {
                window.location = "/DeleteSensorCheckinID"
            }
        }
    </script>

    <fieldset style="text-align: center; max-width: 850px;">
        <div>
            <h3><u><strong>
                <a style="color: red;" href="{{ PageURL }}">Sensor Checkin Statistics</a>
            </strong></u></h3>

            <h4 style="color: #F4A460;">This will automatically refresh every 5 minutes</h4>

            <br>

            <h4 style="color: red;"><strong>
                Clear Old Sensor ID's that have not Checked-in for X Days
            </strong></h4>

            <form id="mqtt-form" class="mui-form" method="POST" action="/DeleteSensorsOlderCheckin"
                  onsubmit="return confirm('Delete Old Sensor Entries?');">
                <div class="mui-textfield">
                    <label style="color: red; font-size: medium;">
                        Days
                        <input style="width: 75px;" type="number" max="3650"
                               name="delete_sensors_older_days"
                               value="{{ DeleteSensorsOlderDays }}">
                    </label>
                </div>
                <button class="mui-btn mui-btn--raised mui--bg-color-indigo-900 mui--color-blue-200" type="submit">
                    Delete
                </button>
            </form>

            <br>
            <br>

            <p style="color: red; font-size: large;">Total Sensors in Database: {{ SensorsInDatabase }}</p>

            <h4><u><strong>
                <a style="color: red;">Sensor Contacts in the past</a>
            </strong></u></h4>

            <p style="color: red; font-size: large;">hour: {{ TotalSensorCountHour }}</p>
            <p style="color: red; font-size: large;">Day: {{ TotalSensorCountDay }}</p>
            <p style="color: red; font-size: large;">2 Days: {{ TotalSensorCount2Day }}</p>
            <p style="color: red; font-size: large;">7 Days: {{ TotalSensorCountWeek }}</p>
            <p style="color: red; font-size: large;">4 Weeks: {{ TotalSensorCountMonth }}</p>
            <p style="color: red; font-size: large;">1 Year: {{ TotalSensorCountYear }}</p>

            <br>
            <form id="mqtt-form" class="mui-form" method="POST" action="/SaveCheckinSettings">
                <div class="mui-textfield">
                    <label style="color: red; font-size: medium;">
                        Check-in times are in UTC 0
                        <br>
                        Offset time by Hour(s)
                        <br>
                        <input style="width: 50px;" type="number" min="-23.0" max="23.0" step="0.25"
                               name="checkin_hour_offset"
                               value="{{ CheckinHourOffset }}">
                    </label>
                </div>
                <br>
                <button type="submit" class="mui-btn mui-btn--raised">Update</button>
            </form>

            <br>
            <br>
            <ul class="mui-tabs__bar">
                <li class="mui--is-active">
                    <a style="color: red; background-color: #212121;" data-mui-toggle="tab"
                       data-mui-controls="main-tab">
                        Main
                    </a>
                </li>

                <li>
                    <a style="color: red; background-color: #212121;" data-mui-toggle="tab"
                       data-mui-controls="sensor-lookup-tab">
                        Sensor Lookup
                    </a>
                </li>
            </ul>

            <div class="mui-tabs__pane mui--is-active" id="main-tab">
                <br>
                <span style="color: greenyellow; white-space: pre-wrap;">{{ CheckinSensorStatistics }}</span>
            </div>
            <div class="mui-tabs__pane" id="sensor-lookup-tab">
                <br>
                <form class="mui-form" method="POST" action="/SearchCheckinSensorID">
                    <div class="mui-textfield">
                        <label style="color: red; font-size: medium;">
                            Sensor ID
                            <br>
                            <input style="width: 375px;" type="text" maxlength="34" name="sensor_id"
                                   placeholder="Eg. KSNLs6RDX4Xvthru6WjjJpDkxdoTR9RUNh" required>
                        </label>
                    </div>
                    <button type="submit" class="mui-btn mui-btn--raised">Submit</button>
                </form>
                <span style="color: greenyellow; white-space: pre-wrap;">{{ SearchSensorInfo }}</span>
                <button type="button" class="mui-btn mui-btn--raised mui--bg-color-pink-900 mui--color-white"
                        onclick="DeleteSensorID();" {{ SearchSensorDeleteDisabled }}>Delete Sensor
                </button>
                <br>
                <br>
                <ul class="mui-tabs__bar">
                    <li class="mui--is-active">
                        <a style="color: red; background-color: #212121;" data-mui-toggle="tab"
                           data-mui-controls="primary-log-tab">
                            Primary Log
                        </a>
                    </li>

                    <li>
                        <a style="color: red; background-color: #212121;" data-mui-toggle="tab"
                           data-mui-controls="sensor-log-tab">
                            Sensor Log
                        </a>
                    </li>
                </ul>

                <div class="mui-tabs__pane mui--is-active" id="primary-log-tab">
                    <br>
                    <div style="text-align: left;">
                        <span style="color: greenyellow; white-space: pre-wrap;">{{ PrimaryLog }}</span>
                    </div>
                </div>
                <div class="mui-tabs__pane" id="sensor-log-tab">
                    <br>
                    <div style="text-align: left;">
                        <span style="color: greenyellow; white-space: pre-wrap;">{{ SensorLog }}</span>
                    </div>
                </div>
            </div>
        </div>
    </fieldset>

{% endblock %}
